<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RGBä¸‰åŸè‰²å…‰äº’å‹•æ•™å­¸ - è‰²å…‰ç…§å°„æ¨¡æ“¬</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            animation: fadeInDown 0.8s ease;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            animation: fadeInUp 0.8s ease;
        }

        /* æ‹–ç–Šå€åŸŸ */
        .drag-area {
            background: #0a0a0a;
            border-radius: 15px;
            height: 500px;
            position: relative;
            overflow: hidden;
            margin-bottom: 20px;
            cursor: move;
            box-shadow: inset 0 0 50px rgba(0,0,0,0.8);
        }

        .drag-area::before {
            content: 'ğŸ¯ æ‹–å‹•åœ“å½¢ä¾†æ··åˆé¡è‰²æˆ–ç…§å°„åœ–åƒ';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: rgba(255,255,255,0.3);
            font-size: 1.2rem;
            pointer-events: none;
            z-index: 1;
        }

        .drag-area.has-circles::before {
            display: none;
        }

        /* åœ–åƒå®¹å™¨ */
        .image-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 220px;
            height: 220px;
            border-radius: 15px;
            overflow: hidden;
            z-index: 2;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            transition: all 0.3s ease;
        }

        .image-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.4) saturate(0.8);
            transition: filter 0.3s ease;
        }

        .color-circle {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            position: absolute;
            cursor: grab;
            transition: transform 0.1s ease, box-shadow 0.3s ease;
            mix-blend-mode: screen;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.3rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .color-circle:active {
            cursor: grabbing;
        }

        .color-circle.dragging {
            z-index: 100;
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }

        .color-circle.red {
            background: radial-gradient(circle, rgba(255,0,0,1) 0%, rgba(255,0,0,0.8) 50%, rgba(255,0,0,0.4) 100%);
            filter: brightness(1.2);
        }

        .color-circle.green {
            background: radial-gradient(circle, rgba(0,255,0,1) 0%, rgba(0,255,0,0.8) 50%, rgba(0,255,0,0.4) 100%);
            filter: brightness(1.2);
        }

        .color-circle.blue {
            background: radial-gradient(circle, rgba(0,0,255,1) 0%, rgba(0,0,255,0.8) 50%, rgba(0,0,255,0.4) 100%);
            filter: brightness(1.2);
        }

        .color-circle:hover {
            box-shadow: 0 0 40px currentColor;
        }

        /* RGBå¼·åº¦æ§åˆ¶å€ */
        .intensity-controls {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .intensity-controls h3 {
            margin-bottom: 15px;
            color: #333;
            font-size: 1.1rem;
        }

        .intensity-group {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .intensity-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .intensity-label {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .intensity-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 15px;
            color: white;
            font-size: 0.85rem;
        }

        .red-badge { background: #ff4444; }
        .green-badge { background: #44ff44; }
        .blue-badge { background: #4444ff; }

        .intensity-slider {
            width: 100%;
            height: 6px;
            border-radius: 5px;
            outline: none;
            -webkit-appearance: none;
            cursor: pointer;
        }

        .intensity-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
            transition: transform 0.2s;
        }

        .intensity-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        .intensity-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        #redIntensity {
            background: linear-gradient(to right, rgba(255,0,0,0.1), rgba(255,0,0,1));
        }

        #greenIntensity {
            background: linear-gradient(to right, rgba(0,255,0,0.1), rgba(0,255,0,1));
        }

        #blueIntensity {
            background: linear-gradient(to right, rgba(0,0,255,0.1), rgba(0,0,255,1));
        }

        .intensity-value {
            background: #f0f0f0;
            padding: 4px 8px;
            border-radius: 6px;
            font-weight: bold;
            font-size: 0.9rem;
            min-width: 40px;
            text-align: center;
        }

        /* æ§åˆ¶é¢æ¿ */
        .controls {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .control-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .control-btn:active {
            transform: translateY(0);
        }

        .control-btn.toggle {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        /* åœ–ç‰‡é¸æ“‡å™¨ */
        .image-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .image-option {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .image-option img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .image-option.active {
            border-color: #667eea;
            transform: scale(1.1);
        }

        .image-option:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        /* æ··åˆçµæœé¡¯ç¤º */
        .mix-result {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
        }

        .result-preview {
            width: 100%;
            height: 80px;
            border-radius: 8px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .result-info {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            text-align: center;
        }

        .info-item {
            background: white;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .info-label {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: #333;
        }

        /* èª¿è‰²æ¿ */
        .color-display {
            width: 100%;
            height: 200px;
            border-radius: 15px;
            margin-bottom: 30px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .color-code {
            background: rgba(255,255,255,0.95);
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .slider-group {
            margin-bottom: 25px;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .color-label {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            color: white;
            font-size: 0.9rem;
        }

        .red-label { background: #ff4444; }
        .green-label { background: #44ff44; }
        .blue-label { background: #4444ff; }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 10px;
            outline: none;
            -webkit-appearance: none;
            cursor: pointer;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        #redSlider {
            background: linear-gradient(to right, #000000, #ff0000);
        }

        #greenSlider {
            background: linear-gradient(to right, #000000, #00ff00);
        }

        #blueSlider {
            background: linear-gradient(to right, #000000, #0000ff);
        }

        .value-display {
            background: #f0f0f0;
            padding: 8px 15px;
            border-radius: 8px;
            font-weight: bold;
            min-width: 50px;
            text-align: center;
        }

        /* é è¨­è‰²å½© */
        .color-presets {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
        }

        .preset-color {
            aspect-ratio: 1;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .preset-color:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .preset-info {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 5px;
            font-size: 0.7rem;
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }

        .preset-color:hover .preset-info {
            transform: translateY(0);
        }

        /* èªªæ˜å€åŸŸ */
        .instructions {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .instructions h3 {
            margin-bottom: 15px;
            color: #333;
        }

        .instructions ul {
            list-style: none;
            padding-left: 0;
        }

        .instructions li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            color: #555;
        }

        .instructions li:before {
            content: 'âœ¨';
            position: absolute;
            left: 0;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .drag-area {
                height: 450px;
            }
            
            .color-circle {
                width: 140px;
                height: 140px;
            }
            
            .image-container {
                width: 180px;
                height: 180px;
            }
            
            .intensity-group {
                grid-template-columns: 1fr;
            }
            
            .controls {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ¨ RGBä¸‰åŸè‰²å…‰äº’å‹•æ•™å­¸</h1>
            <p class="subtitle">æ‹–å‹•åœ“å½¢æ··åˆé¡è‰²ï¼Œæˆ–ç…§å°„å½©è‰²åœ–åƒè§€å¯Ÿè‰²å…‰æ•ˆæœ</p>
        </header>

        <div class="main-content">
            <div class="card">
                <h2 style="margin-bottom: 20px;">ğŸ¯ æ‹–ç–Šæ··åˆå€</h2>
                
                <!-- åœ–ç‰‡é¸æ“‡å™¨ -->
                <div class="image-selector">
                    <div class="image-option active" onclick="changeImage(0)">
                        <img src="https://picsum.photos/seed/nature1/60/60.jpg" alt="è‡ªç„¶é¢¨æ™¯">
                    </div>
                    <div class="image-option" onclick="changeImage(1)">
                        <img src="https://picsum.photos/seed/portrait1/60/60.jpg" alt="äººç‰©è‚–åƒ">
                    </div>
                    <div class="image-option" onclick="changeImage(2)">
                        <img src="https://picsum.photos/seed/city1/60/60.jpg" alt="åŸå¸‚å»ºç¯‰">
                    </div>
                    <div class="image-option" onclick="changeImage(3)">
                        <img src="https://picsum.photos/seed/flower1/60/60.jpg" alt="èŠ±æœµ">
                    </div>
                    <div class="image-option" onclick="changeImage(4)">
                        <img src="https://picsum.photos/seed/food1/60/60.jpg" alt="ç¾é£Ÿ">
                    </div>
                </div>
                
                <div class="drag-area" id="dragArea">
                    <div class="image-container" id="imageContainer">
                        <img src="https://picsum.photos/seed/nature1/220/220.jpg" alt="æ¸¬è©¦åœ–åƒ" id="testImage">
                    </div>
                    <div class="color-circle red" id="redCircle" data-color="red">R</div>
                    <div class="color-circle green" id="greenCircle" data-color="green">G</div>
                    <div class="color-circle blue" id="blueCircle" data-color="blue">B</div>
                </div>
                
                <!-- RGBå¼·åº¦æ§åˆ¶ -->
                <div class="intensity-controls">
                    <h3>ğŸ’¡ RGBå¼·åº¦èª¿æ•´</h3>
                    <div class="intensity-group">
                        <div class="intensity-item">
                            <div class="intensity-label">
                                <span class="intensity-badge red-badge">ç´…è‰²</span>
                                <span class="intensity-value" id="redIntensityValue">100%</span>
                            </div>
                            <input type="range" class="intensity-slider" id="redIntensity" min="0" max="100" value="100">
                        </div>
                        <div class="intensity-item">
                            <div class="intensity-label">
                                <span class="intensity-badge green-badge">ç¶ è‰²</span>
                                <span class="intensity-value" id="greenIntensityValue">100%</span>
                            </div>
                            <input type="range" class="intensity-slider" id="greenIntensity" min="0" max="100" value="100">
                        </div>
                        <div class="intensity-item">
                            <div class="intensity-label">
                                <span class="intensity-badge blue-badge">è—è‰²</span>
                                <span class="intensity-value" id="blueIntensityValue">100%</span>
                            </div>
                            <input type="range" class="intensity-slider" id="blueIntensity" min="0" max="100" value="100">
                        </div>
                    </div>
                </div>
                
                <div class="controls">
                    <button class="control-btn" onclick="resetPositions()">ğŸ”„ é‡ç½®ä½ç½®</button>
                    <button class="control-btn" onclick="randomPositions()">ğŸ² éš¨æ©Ÿä½ç½®</button>
                    <button class="control-btn" onclick="alignCircles()">ğŸ“ å°é½Šåœ“å¿ƒ</button>
                    <button class="control-btn toggle" id="imageToggle" onclick="toggleImage()">ğŸ–¼ï¸ éš±è—åœ–åƒ</button>
                </div>

                <div class="mix-result">
                    <h3 style="margin-bottom: 15px;">æ··åˆçµæœåˆ†æ</h3>
                    <div class="result-preview" id="resultPreview">
                        æ‹–å‹•åœ“å½¢æŸ¥çœ‹æ··åˆæ•ˆæœ
                    </div>
                    <div class="result-info">
                        <div class="info-item">
                            <div class="info-label">é‡ç–Šå€åŸŸ</div>
                            <div class="info-value" id="overlapCount">0</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">æ··åˆé¡è‰²</div>
                            <div class="info-value" id="mixedColor">-</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">RGBå€¼</div>
                            <div class="info-value" id="mixedRGB">-</div>
                        </div>
                    </div>
                </div>

                <div class="instructions">
                    <h3>ğŸ“– ä½¿ç”¨èªªæ˜</h3>
                    <ul>
                        <li>é¸æ“‡ä¸åŒçš„å½©è‰²åœ–åƒé€²è¡Œå¯¦é©—</li>
                        <li>æ‹–å‹•RGBè‰²å…‰åœ“ç…§å°„åœ–åƒè§€å¯Ÿæ•ˆæœ</li>
                        <li>èª¿æ•´å¼·åº¦æ»‘å¡Šæ”¹è®Šè‰²å…‰å¼·åº¦</li>
                        <li>è§€å¯Ÿä¸åŒè‰²å…‰å°å½©è‰²åœ–åƒçš„å½±éŸ¿</li>
                    </ul>
                </div>
            </div>

            <div class="card">
                <h2 style="margin-bottom: 20px;">ğŸšï¸ ç²¾ç¢ºèª¿è‰²æ¿</h2>
                <div class="color-display" id="colorDisplay">
                    <div class="color-code" id="colorCode">RGB(128, 128, 128)</div>
                </div>
                
                <div class="slider-group">
                    <div class="slider-label">
                        <span class="color-label red-label">ç´…è‰² (R)</span>
                        <span class="value-display" id="redValue">128</span>
                    </div>
                    <input type="range" class="slider" id="redSlider" min="0" max="255" value="128">
                </div>

                <div class="slider-group">
                    <div class="slider-label">
                        <span class="color-label green-label">ç¶ è‰² (G)</span>
                        <span class="value-display" id="greenValue">128</span>
                    </div>
                    <input type="range" class="slider" id="greenSlider" min="0" max="255" value="128">
                </div>

                <div class="slider-group">
                    <div class="slider-label">
                        <span class="color-label blue-label">è—è‰² (B)</span>
                        <span class="value-display" id="blueValue">128</span>
                    </div>
                    <input type="range" class="slider" id="blueSlider" min="0" max="255" value="128">
                </div>

                <h3 style="margin-top: 30px; margin-bottom: 15px;">ğŸ¨ å¿«é€Ÿè‰²å½©</h3>
                <div class="color-presets" id="colorPresets"></div>
            </div>
        </div>
    </div>

    <script>
        // é è¨­è‰²å½©ç¯„ä¾‹
        const presetColors = [
            { name: 'ç´…', rgb: [255, 0, 0] },
            { name: 'ç¶ ', rgb: [0, 255, 0] },
            { name: 'è—', rgb: [0, 0, 255] },
            { name: 'é»ƒ', rgb: [255, 255, 0] },
            { name: 'é’', rgb: [0, 255, 255] },
            { name: 'æ´‹ç´…', rgb: [255, 0, 255] },
            { name: 'ç™½', rgb: [255, 255, 255] },
            { name: 'é»‘', rgb: [0, 0, 0] },
            { name: 'æ©™', rgb: [255, 165, 0] },
            { name: 'ç´«', rgb: [128, 0, 128] },
            { name: 'ç²‰', rgb: [255, 192, 203] },
            { name: 'ç°', rgb: [128, 128, 128] }
        ];

        // åœ–åƒé¸é …
        const imageOptions = [
            { seed: 'nature1', name: 'è‡ªç„¶é¢¨æ™¯' },
            { seed: 'portrait1', name: 'äººç‰©è‚–åƒ' },
            { seed: 'city1', name: 'åŸå¸‚å»ºç¯‰' },
            { seed: 'flower1', name: 'èŠ±æœµ' },
            { seed: 'food1', name: 'ç¾é£Ÿ' }
        ];

        let isDragging = false;
        let currentCircle = null;
        let startX, startY, initialX, initialY;
        let imageVisible = true;
        let currentImageIndex = 0;

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeDragAndDrop();
            initializeIntensitySliders();
            initializeSliders();
            initializePresets();
            resetPositions();
            updateColor();
        });

        // åˆå§‹åŒ–æ‹–æ”¾åŠŸèƒ½
        function initializeDragAndDrop() {
            const circles = document.querySelectorAll('.color-circle');
            const dragArea = document.getElementById('dragArea');

            circles.forEach(circle => {
                // æ»‘é¼ äº‹ä»¶
                circle.addEventListener('mousedown', startDrag);
                
                // è§¸æ‘¸äº‹ä»¶
                circle.addEventListener('touchstart', startDrag, { passive: false });
            });

            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
            document.addEventListener('touchmove', drag, { passive: false });
            document.addEventListener('touchend', stopDrag);
        }

        // åˆå§‹åŒ–å¼·åº¦æ»‘å¡Š
        function initializeIntensitySliders() {
            const redIntensity = document.getElementById('redIntensity');
            const greenIntensity = document.getElementById('greenIntensity');
            const blueIntensity = document.getElementById('blueIntensity');

            redIntensity.addEventListener('input', function() {
                updateCircleIntensity('red', this.value);
            });
            
            greenIntensity.addEventListener('input', function() {
                updateCircleIntensity('green', this.value);
            });
            
            blueIntensity.addEventListener('input', function() {
                updateCircleIntensity('blue', this.value);
            });
        }

        // æ›´æ–°åœ“å½¢å¼·åº¦
        function updateCircleIntensity(color, intensity) {
            const value = intensity / 100;
            const circle = document.getElementById(color + 'Circle');
            const valueDisplay = document.getElementById(color + 'IntensityValue');
            
            valueDisplay.textContent = intensity + '%';
            
            // æ›´æ–°åœ“å½¢èƒŒæ™¯å’Œé€æ˜åº¦
            if (color === 'red') {
                circle.style.background = `radial-gradient(circle, rgba(255,0,0,${value}) 0%, rgba(255,0,0,${0.8 * value}) 50%, rgba(255,0,0,${0.4 * value}) 100%)`;
                circle.style.opacity = 0.4 + (0.6 * value);
            } else if (color === 'green') {
                circle.style.background = `radial-gradient(circle, rgba(0,255,0,${value}) 0%, rgba(0,255,0,${0.8 * value}) 50%, rgba(0,255,0,${0.4 * value}) 100%)`;
                circle.style.opacity = 0.4 + (0.6 * value);
            } else if (color === 'blue') {
                circle.style.background = `radial-gradient(circle, rgba(0,0,255,${value}) 0%, rgba(0,0,255,${0.8 * value}) 50%, rgba(0,0,255,${0.4 * value}) 100%)`;
                circle.style.opacity = 0.4 + (0.6 * value);
            }
            
            updateImageLighting();
            updateMixResult();
        }

        // æ›´æ–°åœ–åƒå…‰ç…§æ•ˆæœ
        function updateImageLighting() {
            if (!imageVisible) return;
            
            const redIntensity = document.getElementById('redIntensity').value / 100;
            const greenIntensity = document.getElementById('greenIntensity').value / 100;
            const blueIntensity = document.getElementById('blueIntensity').value / 100;
            
            const redCircle = document.getElementById('redCircle');
            const greenCircle = document.getElementById('greenCircle');
            const blueCircle = document.getElementById('blueCircle');
            const imageContainer = document.getElementById('imageContainer');
            const testImage = document.getElementById('testImage');
            
            const imageRect = imageContainer.getBoundingClientRect();
            const dragAreaRect = document.getElementById('dragArea').getBoundingClientRect();
            
            const imageCenterX = imageRect.left - dragAreaRect.left + imageRect.width / 2;
            const imageCenterY = imageRect.top - dragAreaRect.top + imageRect.height / 2;
            
            // è¨ˆç®—æ¯å€‹è‰²å…‰åœ“èˆ‡åœ–åƒçš„è·é›¢
            const redPos = {
                x: parseFloat(redCircle.style.left) + 90,
                y: parseFloat(redCircle.style.top) + 90
            };
            const greenPos = {
                x: parseFloat(greenCircle.style.left) + 90,
                y: parseFloat(greenCircle.style.top) + 90
            };
            const bluePos = {
                x: parseFloat(blueCircle.style.left) + 90,
                y: parseFloat(blueCircle.style.top) + 90
            };
            
            const redDistance = Math.sqrt(Math.pow(redPos.x - imageCenterX, 2) + Math.pow(redPos.y - imageCenterY, 2));
            const greenDistance = Math.sqrt(Math.pow(greenPos.x - imageCenterX, 2) + Math.pow(greenPos.y - imageCenterY, 2));
            const blueDistance = Math.sqrt(Math.pow(bluePos.x - imageCenterX, 2) + Math.pow(bluePos.y - imageCenterY, 2));
            
            // è¨ˆç®—å…‰ç…§å¼·åº¦ï¼ˆè·é›¢è¶Šè¿‘å…‰ç…§è¶Šå¼·ï¼‰
            const maxDistance = 150;
            const redLight = Math.max(0, 1 - redDistance / maxDistance) * redIntensity;
            const greenLight = Math.max(0, 1 - greenDistance / maxDistance) * greenIntensity;
            const blueLight = Math.max(0, 1 - blueDistance / maxDistance) * blueIntensity;
            
            // è¨ˆç®—æ•´é«”äº®åº¦å’Œè‰²å½©æ•ˆæœ
            const totalLight = Math.min(1, redLight + greenLight + blueLight);
            const brightness = 0.4 + (0.6 * totalLight);
            
            // è¨ˆç®—è‰²åæ•ˆæœ
            const colorMix = `drop-shadow(0 0 ${20 * redLight}px rgba(255,0,0,0.5)) drop-shadow(0 0 ${20 * greenLight}px rgba(0,255,0,0.5)) drop-shadow(0 0 ${20 * blueLight}px rgba(0,0,255,0.5))`;
            
            // æ‡‰ç”¨æ¿¾é¡æ•ˆæœ - ä¿ç•™å½©è‰²åœ–åƒçš„åŸå§‹è‰²å½©
            testImage.style.filter = `brightness(${brightness}) saturate(${0.8 + totalLight * 0.4}) contrast(1.1)`;
            testImage.style.boxShadow = colorMix;
            
            // æ·»åŠ å®¹å™¨ç™¼å…‰æ•ˆæœ
            if (totalLight > 0.3) {
                imageContainer.style.boxShadow = `0 0 ${30 * totalLight}px rgba(${Math.round(255 * redLight)}, ${Math.round(255 * greenLight)}, ${Math.round(255 * blueLight)}, 0.6)`;
            } else {
                imageContainer.style.boxShadow = '0 10px 30px rgba(0,0,0,0.5)';
            }
        }

        // åˆ‡æ›åœ–åƒ
        function changeImage(index) {
            currentImageIndex = index;
            const testImage = document.getElementById('testImage');
            const imageOptions = document.querySelectorAll('.image-option');
            
            // æ›´æ–°åœ–åƒ
            testImage.src = `https://picsum.photos/seed/${imageOptions[index].seed}/220/220.jpg`;
            
            // æ›´æ–°é¸ä¸­ç‹€æ…‹
            imageOptions.forEach((option, i) => {
                if (i === index) {
                    option.classList.add('active');
                } else {
                    option.classList.remove('active');
                }
            });
            
            // é‡æ–°æ‡‰ç”¨å…‰ç…§æ•ˆæœ
            updateImageLighting();
        }

        // åˆ‡æ›åœ–åƒé¡¯ç¤º
        function toggleImage() {
            const imageContainer = document.getElementById('imageContainer');
            const toggleBtn = document.getElementById('imageToggle');
            
            imageVisible = !imageVisible;
            
            if (imageVisible) {
                imageContainer.style.display = 'block';
                toggleBtn.textContent = 'ğŸ–¼ï¸ éš±è—åœ–åƒ';
            } else {
                imageContainer.style.display = 'none';
                toggleBtn.textContent = 'ğŸ–¼ï¸ é¡¯ç¤ºåœ–åƒ';
            }
        }

        function startDrag(e) {
            e.preventDefault();
            isDragging = true;
            currentCircle = e.target;
            currentCircle.classList.add('dragging');
            
            const touch = e.touches ? e.touches[0] : e;
            startX = touch.clientX;
            startY = touch.clientY;
            
            const rect = currentCircle.getBoundingClientRect();
            const parentRect = currentCircle.parentElement.getBoundingClientRect();
            initialX = rect.left - parentRect.left;
            initialY = rect.top - parentRect.top;
            
            document.getElementById('dragArea').classList.add('has-circles');
        }

        function drag(e) {
            if (!isDragging || !currentCircle) return;
            e.preventDefault();
            
            const touch = e.touches ? e.touches[0] : e;
            const deltaX = touch.clientX - startX;
            const deltaY = touch.clientY - startY;
            
            const dragArea = document.getElementById('dragArea');
            const areaRect = dragArea.getBoundingClientRect();
            
            let newX = initialX + deltaX;
            let newY = initialY + deltaY;
            
            // é™åˆ¶åœ¨æ‹–æ›³å€åŸŸå…§
            const circleSize = 180;
            newX = Math.max(0, Math.min(newX, areaRect.width - circleSize));
            newY = Math.max(0, Math.min(newY, areaRect.height - circleSize));
            
            currentCircle.style.left = newX + 'px';
            currentCircle.style.top = newY + 'px';
            
            updateImageLighting();
            updateMixResult();
        }

        function stopDrag() {
            if (currentCircle) {
                currentCircle.classList.remove('dragging');
            }
            isDragging = false;
            currentCircle = null;
        }

        // é‡ç½®ä½ç½®
        function resetPositions() {
            const dragArea = document.getElementById('dragArea');
            const areaRect = dragArea.getBoundingClientRect();
            const circleSize = 180;
            
            const positions = [
                { x: areaRect.width * 0.15 - circleSize/2, y: areaRect.height * 0.2 - circleSize/2 },
                { x: areaRect.width * 0.5 - circleSize/2, y: areaRect.height * 0.2 - circleSize/2 },
                { x: areaRect.width * 0.85 - circleSize/2, y: areaRect.height * 0.2 - circleSize/2 }
            ];
            
            document.getElementById('redCircle').style.left = positions[0].x + 'px';
            document.getElementById('redCircle').style.top = positions[0].y + 'px';
            document.getElementById('greenCircle').style.left = positions[1].x + 'px';
            document.getElementById('greenCircle').style.top = positions[1].y + 'px';
            document.getElementById('blueCircle').style.left = positions[2].x + 'px';
            document.getElementById('blueCircle').style.top = positions[2].y + 'px';
            
            // é‡ç½®å¼·åº¦
            document.getElementById('redIntensity').value = 100;
            document.getElementById('greenIntensity').value = 100;
            document.getElementById('blueIntensity').value = 100;
            updateCircleIntensity('red', 100);
            updateCircleIntensity('green', 100);
            updateCircleIntensity('blue', 100);
            
            document.getElementById('dragArea').classList.add('has-circles');
            updateMixResult();
        }

        // éš¨æ©Ÿä½ç½®
        function randomPositions() {
            const dragArea = document.getElementById('dragArea');
            const areaRect = dragArea.getBoundingClientRect();
            const circleSize = 180;
            
            const circles = ['redCircle', 'greenCircle', 'blueCircle'];
            
            circles.forEach(id => {
                const circle = document.getElementById(id);
                const maxX = areaRect.width - circleSize;
                const maxY = areaRect.height - circleSize;
                
                const randomX = Math.random() * maxX;
                const randomY = Math.random() * maxY;
                
                circle.style.left = randomX + 'px';
                circle.style.top = randomY + 'px';
            });
            
            document.getElementById('dragArea').classList.add('has-circles');
            updateImageLighting();
            updateMixResult();
        }

        // å°é½Šåœ“å¿ƒ
        function alignCircles() {
            const dragArea = document.getElementById('dragArea');
            const areaRect = dragArea.getBoundingClientRect();
            const circleSize = 180;
            
            const centerX = areaRect.width / 2 - circleSize / 2;
            const centerY = areaRect.height / 2 - circleSize / 2;
            
            ['redCircle', 'greenCircle', 'blueCircle'].forEach(id => {
                const circle = document.getElementById(id);
                circle.style.left = centerX + 'px';
                circle.style.top = centerY + 'px';
            });
            
            document.getElementById('dragArea').classList.add('has-circles');
            updateImageLighting();
            updateMixResult();
        }

        // æ›´æ–°æ··åˆçµæœ
        function updateMixResult() {
            const redCircle = document.getElementById('redCircle');
            const greenCircle = document.getElementById('greenCircle');
            const blueCircle = document.getElementById('blueCircle');
            
            const redPos = {
                x: parseFloat(redCircle.style.left) + 90,
                y: parseFloat(redCircle.style.top) + 90
            };
            const greenPos = {
                x: parseFloat(greenCircle.style.left) + 90,
                y: parseFloat(greenCircle.style.top) + 90
            };
            const bluePos = {
                x: parseFloat(blueCircle.style.left) + 90,
                y: parseFloat(blueCircle.style.top) + 90
            };
            
            // è¨ˆç®—è·é›¢
            const rgDistance = Math.sqrt(Math.pow(redPos.x - greenPos.x, 2) + Math.pow(redPos.y - greenPos.y, 2));
            const gbDistance = Math.sqrt(Math.pow(greenPos.x - bluePos.x, 2) + Math.pow(greenPos.y - bluePos.y, 2));
            const rbDistance = Math.sqrt(Math.pow(redPos.x - bluePos.x, 2) + Math.pow(redPos.y - bluePos.y, 2));
            
            // ç²å–å¼·åº¦å€¼
            const redIntensity = document.getElementById('redIntensity').value / 100;
            const greenIntensity = document.getElementById('greenIntensity').value / 100;
            const blueIntensity = document.getElementById('blueIntensity').value / 100;
            
            const overlapThreshold = 90;
            let overlapCount = 0;
            let mixedColor = 'ç„¡';
            let mixedRGB = '-';
            
            if (rgDistance < overlapThreshold && redIntensity > 0.1 && greenIntensity > 0.1) overlapCount++;
            if (gbDistance < overlapThreshold && greenIntensity > 0.1 && blueIntensity > 0.1) overlapCount++;
            if (rbDistance < overlapThreshold && redIntensity > 0.1 && blueIntensity > 0.1) overlapCount++;
            
            if (overlapCount === 3) {
                // è¨ˆç®—å¯¦éš›æ··åˆé¡è‰²
                const r = Math.round(255 * redIntensity);
                const g = Math.round(255 * greenIntensity);
                const b = Math.round(255 * blueIntensity);
                
                if (r === 255 && g === 255 && b === 255) {
                    mixedColor = 'ç´”ç™½è‰²';
                } else {
                    mixedColor = 'æ··åˆè‰²';
                }
                mixedRGB = `RGB(${r}, ${g}, ${b})`;
                document.getElementById('resultPreview').style.background = `rgb(${r}, ${g}, ${b})`;
                document.getElementById('resultPreview').style.color = (r + g + b) / 3 > 128 ? '#333' : 'white';
                document.getElementById('resultPreview').textContent = mixedColor + ' - ä¸‰åœ“é‡ç–Š';
            } else if (overlapCount === 2) {
                if (rgDistance < overlapThreshold) {
                    const r = Math.round(255 * redIntensity);
                    const g = Math.round(255 * greenIntensity);
                    mixedColor = 'é»ƒè‰²ç³»';
                    mixedRGB = `RGB(${r}, ${g}, 0)`;
                    document.getElementById('resultPreview').style.background = `rgb(${r}, ${g}, 0)`;
                    document.getElementById('resultPreview').style.color = (r + g) / 2 > 128 ? '#333' : 'white';
                    document.getElementById('resultPreview').textContent = 'é»ƒè‰²ç³» - ç´…+ç¶ ';
                } else if (gbDistance < overlapThreshold) {
                    const g = Math.round(255 * greenIntensity);
                    const b = Math.round(255 * blueIntensity);
                    mixedColor = 'é’è‰²ç³»';
                    mixedRGB = `RGB(0, ${g}, ${b})`;
                    document.getElementById('resultPreview').style.background = `rgb(0, ${g}, ${b})`;
                    document.getElementById('resultPreview').style.color = (g + b) / 2 > 128 ? '#333' : 'white';
                    document.getElementById('resultPreview').textContent = 'é’è‰²ç³» - ç¶ +è—';
                } else {
                    const r = Math.round(255 * redIntensity);
                    const b = Math.round(255 * blueIntensity);
                    mixedColor = 'æ´‹ç´…ç³»';
                    mixedRGB = `RGB(${r}, 0, ${b})`;
                    document.getElementById('resultPreview').style.background = `rgb(${r}, 0, ${b})`;
                    document.getElementById('resultPreview').style.color = (r + b) / 2 > 128 ? '#333' : 'white';
                    document.getElementById('resultPreview').textContent = 'æ´‹ç´…ç³» - ç´…+è—';
                }
            } else if (overlapCount === 1) {
                document.getElementById('resultPreview').style.background = '#666';
                document.getElementById('resultPreview').style.color = 'white';
                document.getElementById('resultPreview').textContent = 'éƒ¨åˆ†é‡ç–Š';
            } else {
                document.getElementById('resultPreview').style.background = '#333';
                document.getElementById('resultPreview').style.color = 'white';
                document.getElementById('resultPreview').textContent = 'ç„¡é‡ç–Š';
            }
            
            document.getElementById('overlapCount').textContent = overlapCount;
            document.getElementById('mixedColor').textContent = mixedColor;
            document.getElementById('mixedRGB').textContent = mixedRGB;
        }

        // åˆå§‹åŒ–æ»‘å¡Š
        function initializeSliders() {
            const redSlider = document.getElementById('redSlider');
            const greenSlider = document.getElementById('greenSlider');
            const blueSlider = document.getElementById('blueSlider');

            [redSlider, greenSlider, blueSlider].forEach(slider => {
                slider.addEventListener('input', updateColor);
            });
        }

        // åˆå§‹åŒ–é è¨­è‰²å½©
        function initializePresets() {
            const presetsContainer = document.getElementById('colorPresets');
            
            presetColors.forEach(preset => {
                const presetDiv = document.createElement('div');
                presetDiv.className = 'preset-color';
                presetDiv.style.background = `rgb(${preset.rgb.join(',')})`;
                presetDiv.onclick = () => applyPreset(preset.rgb);
                
                const infoDiv = document.createElement('div');
                infoDiv.className = 'preset-info';
                infoDiv.innerHTML = preset.name;
                
                presetDiv.appendChild(infoDiv);
                presetsContainer.appendChild(presetDiv);
            });
        }

        // æ›´æ–°é¡è‰²é¡¯ç¤º
        function updateColor() {
            const red = document.getElementById('redSlider').value;
            const green = document.getElementById('greenSlider').value;
            const blue = document.getElementById('blueSlider').value;
            
            document.getElementById('redValue').textContent = red;
            document.getElementById('greenValue').textContent = green;
            document.getElementById('blueValue').textContent = blue;
            
            const color = `rgb(${red}, ${green}, ${blue})`;
            document.getElementById('colorDisplay').style.background = color;
            document.getElementById('colorCode').textContent = `RGB(${red}, ${green}, ${blue})`;
            
            const brightness = (parseInt(red) * 299 + parseInt(green) * 587 + parseInt(blue) * 114) / 1000;
            document.getElementById('colorCode').style.color = brightness > 128 ? '#333' : '#fff';
        }

        // æ‡‰ç”¨é è¨­è‰²å½©
        function applyPreset(rgb) {
            document.getElementById('redSlider').value = rgb[0];
            document.getElementById('greenSlider').value = rgb[1];
            document.getElementById('blueSlider').value = rgb[2];
            updateColor();
        }
    </script>
</body>
</html>